
# Setting Up a Local Git Repository

I decided to reverse the traditional order of a *working with git* discussion.
Most discussions would start with the basic commands. A discussion of `git log`,
`git diff`, and branches would normally be left as follow-up discussion.

There are two main goals for this discussion:

  1. Motivate the use of Git (i.e., show git's value).
  2. Demonstrate how to set up a basic git repo.


## Basic Commands

Before we can discuss *merge* and *rebase*, we must focus on the basic
commands:

  - `git init` - Initialize a repository (repo) in the current directory
  - `git clone` - *clone* (i.e., copy) a remote repo.
  - `git add` - record files or changes to files.
  - `git rm` - remove one or more files
  - `git commit` and `git commit -m` - package together all *staged* changes
  - `git push` - *push* (i.e., send) all local changes to a remote repo.
  - `git pull` - *pull* (i.e., retrieve) all changes from a remote repo.

We have already discussed a few of the more advanced commands...

  - `git log` - examine the commit history. *This covered in a future section*.
  - `git diff` - examine the differences between two commits.
  - `git difftool` - examine the differences between two commits in a more human
    readable form.

There is one more type of command we will need to set up a repository... the
`git config` command. We will use `git config` to set:

  - author name
  - author email


## Getting Started

The practical (i.e., hands-on) part of this workshop will assume a terminal
environment and terminal commands. You may use a graphical client, e.g.,

  - [Eclipse](https://www.eclipse.org/downloads/packages/release/2019-12/r/eclipse-ide-enterprise-java-developers)
  - [VSCode](https://code.visualstudio.com/)
  - [Git Kraken](https://www.gitkraken.com/)
  - [gitk](https://git-scm.com/docs/gitk)
  - [Sublime Text or Sublime Merge](https://www.sublimetext.com/)

However, if you opt to use a graphical client you will need to locate the
equivalent git commands within the client.


### Opening the Terminal

If you are on Windows, open:

  - [Cygwin](https://www.cygwin.com/)
  - [WSL Bash](https://docs.microsoft.com/en-us/windows/wsl/install-win10)
  - [Git Bash](https://www.atlassian.com/git/tutorials/git-bash)
  - [git for Windows](https://gitforwindows.org/)

If you are on macOS or Linux, open your terminal.

> If you need to install git, <https://git-scm.com/downloads> provides a set of
> instructions for Windows, macOS and Linux.


### Creating a New Repository

We will focus on creating a brand new local repository (repo). For now we will
not link it to GitHub, GitLab, or another remote host.

Since git repos need code... we will use one of my Python lectures from CS 417
(Computational Methods). Open [Python non-linear solver discussion](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
in your web browser.

  1. In your terminal create a new folder. You may use any name you choose
     (provided there are no spaces in the directory name).

  ```sh
  mkdir git-workshop
  ```

  2. Change into the new folder.

  ```sh
  cd git-workshop
  ```

  3. Initialize the git repo.

  ```sh
  git init .
  ```

  4. Set your name (I have entered mine as an example).

   ```sh
   git config user.name "Thomas J. Kennedy"
   ```

  5. Set your email (I have entered mine as an example).

  ```sh
  git config user.email "tkennedy@cs.odu.edu"
  ```

*Note:* I prefer to set my name and email for each repo. If you want to set
your name and email globally (i.e., for all repos) add `--global` after
`git config`.


### Adding Some Code

Since this is a git workshop (and not a programming workshop) we will use the
code examples from
[a CS 417 Python non-linear solver discussion](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
to simulate writing code.

Before we add code... two files should be added:

  1. `.gitignore` - a set of file patterns to ignore.
  2. `README.md` - a description of the program, its dependencies, and how to
     run the program.


#### .gitignore

We will start with a `.gitignore` file. This file should always be added first!
Since we will be working with Python code... our `.gitignore` will be short.

```
# General Ignore Rules
**.zip
**.pyc
**/docs

# Python Disttools
MANIFEST

# Python Tox
**.tox
```

These rules will depend on the language (or languages you are using). You will
probably end up adding a few rules to ignore files generated by your IDE or
editor.

My CS 330 Review Repository has fairly long set of rules.

<details>

<summary><i>CS 330 .gitignore File</i></summary>

```
# General Ignore Rules
**/documentation/
**.o
**.exe
**.zip
**.class
**.jar
!**gradle/wrapper/*.jar
**.pyc
**/docs

# Binary Specific Ignore rules
**/ll2
**leak.out*
**storage
**runShapes
**runshapes
**updateRoom
**registration
**pointerReview

**/build/
**/.gradle/

# Assignment Ignore Rules
**Assignment-0*

# Eclipse Project Ignore Rules
**.project
**.settings
**.classpath

# Latex Ignore Rules
**.aux

# Scratch (temp) File & Directory Ignore rules
Scratch
**.bak

# Vim rules
**.swp

# Python Coverage (coverage.py) Rules
**/.coverage
**/htmlcov

# Python Disttools
MANIFEST

# Python Tox
**.tox

# Style Check reports
**style-check*

# Rust
**/target

# output comparison
**/out-Rust.txt
**/out-rust.txt
**/out-cpp.txt

# Gcovr rules
**/source/*.html
**.gcda
**.gcno

```

</details>

  1. Pick one of the two example `.gitignore` files.
  2. Copy the contents into a new `.gitignore` file in your repo.
  3. Run `git add .gitignore`
  4. Run `git commit -m "Add .gitignore file"`


#### README.md

A Readme file is a developer getting started guide. It tells anyone cloning your
repo:

  - What to install
  - How to install everything
  - How to compile (if necessary)
  - How to run the program
  - What to expect in typical input
  - What to expect in typical output

We will create a [multimarkdown](https://michaelhyatt.com/multimarkdown/) style
`README.md`. We will base our document on [what I require of my CS 417/517
students](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/exampleReadme/index.html#python-example).


  1. Create a new file `README.md` in your repo.
  2. Copy-and-Paste the following content into the file.


  ````markdown
  # Requirements

    * Python 3.7

  > This code makes use of the `f"..."` or [f-string
  > syntax](https://www.python.org/dev/peps/pep-0498/). This syntax was
  > introduced in Python 3.6.


  # Sample Execution & Output

  If run without command line arguments, using

  ```
  python newtons_method.py
  ```

  the following usage message will be displayed.

  ```
  Usage: ./newtons_method.py initial_guess
  ```
  ````

  3. Run `git add README.md`
  4. Run `git commit -m "Add initial README file"`

*Note:* We should probably expand this file to include sample output for a provided
input.

Perform a quick check of your repo with `git log`. You should see something
similar to

```
commit e08c3d8d79a9f2650e7b5a7a9984e582e2814dbe
Author: Thomas J. Kennedy <tkennedy@cs.odu.edu>
Date:   Mon Mar 2 15:18:42 2020 -0500

    Add initial README file

commit d8aa52c01fa2f9d7586a44bcd28dbe171a2e14ac
Author: Thomas J. Kennedy <tkennedy@cs.odu.edu>
Date:   Mon Mar 2 15:17:38 2020 -0500

    Add .gitignore file
```


#### Adding Some Python Code

Now we are ready to start adding some actual code. Both `.gitignore`
and `README.md` files should always be created proactively during initial repo
creation. These files must never be an afterthought.

  1. Create new Python file named `newtons_method.py`.
  2. Copy the example code from the `newtons_method_1.py` listing from
     [here](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
     into the file.
  3. Run `git add newtons_method.py`
  4. Run `git commit -m "Add initial draft of newton's method code"`
  5. Copy the example code from the `newtons_method_2.py` listing from
     [here](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
     into `newtons_method.py`, replacing the previous contents.
  6. Run `git add .`
  7. Run `git commit -m "Tweak code to use tuples and tuple unpacking"`
  8. Copy the example code from the `newtons_method_3.py` listing from
     [here](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
     into `newtons_method.py`, replacing the previous contents.
  8. Run `git add .`
  8. Run `git commit -m "Annotate code with Python type hints"`
  8. Copy the example code from the `newtons_method_4.py` listing from
     [here](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
     into `newtons_method.py`, replacing the previous contents.
  8. Run `git add .`
  8. Run `git commit -m "Add missing pydoc function docstrings"`
  8. Copy the example code from the `newtons_method_5.py` listing from
     [here](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
     into `newtons_method.py`, replacing the previous contents.
  8. Run `git add .`
  8. Run `git commit -m "Clean up unused imports & add main function docstring"`
  8. Copy the example code from the `newtons_method_6.py` listing from
     [here](https://www.cs.odu.edu/~tkennedy/cs417/latest/Public/solverDiscussion/)
     into `newtons_method.py`, replacing the previous contents.
  8. Run `git add .`
  8. Run `git commit -m "Modify code to use Python's Decimal type instead of float"`

Let us make one final edit. Let us fix the missing output listing in `README.md`.

  1. Open `README.md`
  2. Add the following content to the end of the file.

  ````

  If run using

  ```
  python newtons_method.py 2
  ```

  output similar to

  ```
  x = 1.0000000469590518 | f(x) = 9.391810573688986e-08 | 5 iterations
  ```

  should be generated.
  ````

  3. Run `git add .`
  4. Run `git commit -m "Add missing sample output to README"`


### Adding a Remote

Now that we have a repo with actual code... we can:

  - Run `git status`.
  - Run variants of `git log`.
  - Examine changes with `git diff` and `git difftool`.

However, it is about time we added a remote repo. Run

```
git remote -v
```

You will recieve no output. Since we have not set up a remote repo on Github,
GitLab or another service that is expected.

  - I will assume you have an ssh key pair prepared and set up with your
     service of choice.
    - Github has an [ssh key
      guide](https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent).
    - GitLab also has an [ssh key guide](https://docs.gitlab.com/ee/ssh/).
  - I will also assume you have an empty repo created with your service of choice.

Now let us add the remote repo.

  1. Locate your repo's SSH URL. It can usually be found under the *clone* button.
     The URL should be in a format similar to `git@git-community.cs.odu.edu:tkennedy/git-workshop.git`.
  2. In your repo run `git remote add origin URL_REPO`.
  3. Run `git remote -v`. You should see output simliar to

  ```
  origin  git@git-community.cs.odu.edu:tkennedy/git-workshop.git (fetch)
  origin  git@git-community.cs.odu.edu:tkennedy/git-workshop.git (push)

  ```

Now it is time to push all of our work.

  1. Run `git push -u origin master`
  2. Open the web version of your repo (e.g., your exiting Github repo or
     GitLab repo) and examine the results.
  3. If you would like an existing example... navigate to <https://git-community.cs.odu.edu/tkennedy/git-workshop>.
  4. Make a change to `README.md` through the web interface.
  5. Go back to your terminal.
  6. Run `git pull`

You should now see the changes to `README.md` in your local copy of the file.


# Cloning an Existing Repository

Cloning a git repo is far less work than setting one up locally (from scratch).

  1. Find the URL of a repo you want to clone (and for which you have edit
     privileges).
  2. Make sure you have `cd`-ed out of any existing repos.
  3. Run `git clone REPO_URL`

You now have a local copy of the repo. You can `push`, `pull`, examine and edit
the repo using the commands we have discussed.


# Future Work

If time permits we will discuss:

  - `git merge`
  - `git blame`
  -  git aliases

